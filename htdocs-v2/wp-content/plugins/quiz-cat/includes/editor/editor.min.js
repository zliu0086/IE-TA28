function attach_add_answer_button_handlers_free(){var _=jQuery;_(".fca_qc_add_answer_btn").unbind("click"),_(".fca_qc_add_answer_btn").click(function(){var t=parseInt(_(this).siblings(".fca_qc_answer_input_div").length+1),a=parseInt(_(this).closest(".fca_qc_question_item").attr("id").replace(/[^0-9.]/g,"")),e=fcaQcAdminData.answerDiv.replace(/{{ANSWER_NUMBER}}/g,t);e=(e=e.replace(/{{QUESTION_NUMBER}}/g,a)).replace(/{{ID}}/g,fca_qc_new_GUID()),_(this).before(e),attach_delete_button_handlers(),attach_image_upload_handlers()})}function attach_delete_button_handlers(){var _=jQuery;_(".fca_qc_delete_icon").unbind("click"),_(".fca_qc_delete_icon_confirm").click(function(){_(this).closest("."+_(this).data("target")).remove(),_(this.parentNode).hasClass("fca_qc_personality_result_item")?add_result_personality_result_text_handlers():setScoreRanges()}),_(".fca_qc_delete_icon_cancel").click(function(){_(this).hide().siblings(".fca_qc_delete_icon").hide(),_(this).siblings(".fca_qc_delete_button").show()}),_(".fca_qc_delete_button").click(function(){_(this).siblings(".fca_qc_delete_icon").show(),_(this).hide()})}function add_result_heading_text_handlers(){var _=jQuery;_(".fca_qc_quiz_result").unbind("keyup"),_(".fca_qc_quiz_result").keyup(function(){_(this).closest(".fca_qc_result_input_div").siblings(".fca_qc_result_label").children(".fca_qc_result_score_title").html(_(this).val())})}function add_question_heading_text_handlers(){var _=jQuery;_(".fca_qc_question_text").unbind("keyup"),_(".fca_qc_question_text").keyup(function(){_(this).closest(".fca_qc_question_input_div").prev().children(".fca_qc_quiz_heading_text").html(_(this).val())})}function add_question_and_result_click_toggles(){var _=jQuery;_(".fca_qc_question_item, .fca_qc_result_item").unbind("click"),_(".fca_qc_question_item").click(function(t){var a=_(t.target).hasClass("fca_qc_delete_icon");!1!==dragCheck||a||(_(".fca_qc_question_input_div").not(_(this).find(".fca_qc_question_input_div")).hide(),_(this).find(".fca_qc_question_input_div").toggle("fast"))}),_(".fca_qc_result_item").click(function(t){var a=_(t.target).hasClass("fca_qc_delete_icon");!1!==dragCheck||a||(_(".fca_qc_result_input_div").not(_(this).find(".fca_qc_result_input_div")).hide(),_(this).find(".fca_qc_result_input_div").toggle("fast"))}),_(".fca_qc_question_input_div, .fca_qc_result_input_div, .fca_qc_delete_icon").bind("click",function(_){_.stopPropagation()})}function fca_qc_save_question_json(_){var t=jQuery,a=[],e=[];e=0===t("#fca_qc_quiz_type_meta_box").length||"mc"===t("#fca_qc_quiz_type").val()?t(".fca_qc_question_item").not(".fca_qc_personality_question_item"):t(".fca_qc_personality_question_item"),t(e).each(function(){var _=[];t(this).find(".fca_qc_answer_input_div").each(function(){_.push({answer:t(this).find(".fca_qc_question_texta").val(),img:t(this).find(".fca_qc_image_input").val(),id:t(this).find(".fca_qc_id").val(),hint:t(this).find(".fca_qc_hint_tr .fca_qc_question_texta").val(),results:t(this).find(".fca_qc_multiselect").val()})}),a.push({question:t(this).find(".fca_qc_question_text").val(),img:t(this).find(".fca_qc_image_input").val(),id:t(this).find(".fca_qc_id").val(),answers:_})}),t("#fca_qc_questions_json").val(JSON.stringify(a)),_.submit()}function setScoreRanges(){var _=jQuery,t=_(".fca_qc_question_item").not(".fca_qc_personality_question_item").length,a=_(".fca_qc_result_item").not(".fca_qc_personality_result_item").length,e=parseInt((t+1)/a),c=(t+1)%a,i=0;_(".fca_qc_result_item").not(".fca_qc_personality_result_item").each(function(){if(i<=t){var a=i,s=0;a==t?s=a:(s=a+(e-1),0!==c&&(s+=1,c-=1),s>t&&(s=t)),i=s+1,_(this).children(".fca_qc_result_min").attr("value",a),_(this).children(".fca_qc_result_max").attr("value",s),s==a?_(this).children(".fca_qc_result_label").children(".fca_qc_result_score_value").html(a+" "+fcaQcAdminData.points_string+": "):_(this).children(".fca_qc_result_label").children(".fca_qc_result_score_value").html(a+"-"+s+" "+fcaQcAdminData.points_string+": ")}else _(this).children(".fca_qc_result_label").children(".fca_qc_result_score_value").html(fcaQcAdminData.unused_string)})}function setQuestionNumbers(_){var t=jQuery,a=1;_.find(".fca_qc_question_item").each(function(){t(this).find(".fca_qc_quiz_heading_question_number").html(fcaQcAdminData.question_string+" "+a+": "),a+=1})}function attach_image_upload_handlers(){var _=jQuery;_(".fca_qc_quiz_image_upload_btn, .fca_qc_image, .fca_qc_quiz_image_change_btn").unbind("click"),_(".fca_qc_quiz_image_upload_btn, .fca_qc_image, .fca_qc_quiz_image_change_btn").click(function(t){t.preventDefault();var a=_(this);_(this).hasClass("fca_qc_quiz_image_change_btn")?a=_(this.parentNode).siblings(".fca_qc_quiz_image_upload_btn"):_(this).hasClass("fca_qc_image")&&(a=_(this).siblings(".fca_qc_quiz_image_upload_btn"));var e=wp.media({frame:"post",title:fcaQcAdminData.selectImage_string,multiple:!1}).open().on("insert",function(){var _=e.state().get("selection").first(),t=e.state().display(_).toJSON(),c=(_=_.toJSON()).sizes[t.size].url;c&&(a.siblings(".fca_qc_image_input").attr("value",c),a.siblings(".fca_qc_image").attr("src",c),a.siblings(".fca_qc_image_hover_controls").find(".fca_qc_quiz_image_change_btn").show(),a.siblings(".fca_qc_image_hover_controls").find(".fca_qc_quiz_image_revert_btn").show()),a.hide()})}),_(".fca_qc_quiz_image_revert_btn").unbind("click"),_(".fca_qc_quiz_image_revert_btn").click(function(t){_(this.parentNode).siblings(".fca_qc_image_input").attr("value",""),_(this.parentNode).siblings(".fca_qc_image").attr("src",""),_(this.parentNode).siblings(".fca_qc_quiz_image_upload_btn").show(),_(this).hide(),_(this).siblings(".fca_qc_quiz_image_upload_btn").hide()})}function add_drag_and_drop_sort(){var _=jQuery;_(".fca_qc_sortable_results, .fca_qc_sortable_questions").sortable({revert:!0,cancel:":input,button, .fca-wysiwyg-html",start:function(){dragCheck=!0},stop:function(){dragCheck=!1,fca_attach_wysiwyg()}}),_(".fca_qc_sortable_results").unbind("sortupdate"),_(".fca_qc_sortable_results").on("sortupdate",function(_,t){setScoreRanges()}),_(".fca_qc_sortable_questions").unbind("sortupdate"),_(".fca_qc_sortable_questions").on("sortupdate",function(t,a){setQuestionNumbers(_(this))})}function fca_qc_new_GUID(){var _=4294967296*Math.random()>>>0,t=4294967296*Math.random()>>>0,a=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0;return fca_qc_hash_seed[255&_]+fca_qc_hash_seed[_>>8&255]+fca_qc_hash_seed[_>>16&255]+fca_qc_hash_seed[_>>24&255]+"-"+fca_qc_hash_seed[255&t]+fca_qc_hash_seed[t>>8&255]+"-"+fca_qc_hash_seed[t>>16&15|64]+fca_qc_hash_seed[t>>24&255]+"-"+fca_qc_hash_seed[63&a|128]+fca_qc_hash_seed[a>>8&255]+"-"+fca_qc_hash_seed[a>>16&255]+fca_qc_hash_seed[a>>24&255]+fca_qc_hash_seed[255&e]+fca_qc_hash_seed[e>>8&255]+fca_qc_hash_seed[e>>16&255]+fca_qc_hash_seed[e>>24&255]}function fca_qc_attach_radio_selects(){var _=jQuery;_(".qc_radio_input").change(function(){_(this).closest(".radio-toggle").children("label").removeClass("selected"),_(this).closest("label").addClass("selected")})}jQuery(document).ready(function(_){_(".meta-box-sortables").sortable({disabled:!0}),_(".postbox .hndle").css("cursor","pointer"),fca_qc_attach_radio_selects(),_(".fca_qc_custom_css").length>0&&wp.codeEditor.initialize(_(".fca_qc_custom_css"),fcaQcAdminData.code_editor);var t=_(".fca_qc_question_item").length,a=_(".fca_qc_result_item ").length;""===_("#post_name").val()&&_("#post_name").val(_("#post_ID").val()),0===_("#fca_qc_quiz_type_meta_box").length&&_("#fca_qc_questions_meta_box, #fca_qc_add_result_meta_box").show(),_(".onoffswitch-inner").each(function(){_(this).attr("data-content-on",fcaQcAdminData.on_string),_(this).attr("data-content-off",fcaQcAdminData.off_string)}),_(".fca_qc_question_input_div").length>1&&_(".fca_qc_question_input_div").hide(),_(".fca_qc_result_input_div").length>1&&_(".fca_qc_result_input_div").hide();var e='<button type="submit" class="button-primary" id="fca_qc_submit_button">'+fcaQcAdminData.save_string+"</buttton>",c='<button type="button" class="button-secondary" id="fca_qc_preview_button">'+fcaQcAdminData.preview_string+"</buttton>";_("#normal-sortables").append(e),_("#fca_qc_submit_button").click(function(t){_(window).unbind("beforeunload"),t.preventDefault();var a=_(this).closest("form");return a.removeAttr("target"),_("#fca_qc_quiz_preview_url").val(""),fca_qc_save_question_json(a),!1}),_("#normal-sortables").append(c),_("#fca_qc_preview_button").click(function(t){t.preventDefault();var a=_(this).closest("form");return a.prop("target","_blank"),fca_qc_save_question_json(a),!1}),_("#submitdiv").hide(),_(".fca_qc_image").each(function(t){""!==_(this).attr("src")&&_(this).siblings(".fca_qc_quiz_image_upload_btn").hide()}),jQuery.widget.bridge("jQueryUITooltipFCAQC",jQuery.ui.tooltip),_(".fca_qc_tooltip").jQueryUITooltipFCAQC({position:{my:"left",at:"right+2"}}),_("#wpbody-content").show(),_("#editor-nav").click(function(){_(".nav-tab-active").removeClass("nav-tab-active"),_(this).addClass("nav-tab-active").blur(),_("#fca_qc_quiz_settings_meta_box, #fca_qc_social_sharing_meta_box, #fca_qc_email_optin_meta_box, #fca_qc_appearance_meta_box").hide(),_("#fca_qc_description_meta_box").show(),0===_("#fca_qc_quiz_type_meta_box").length||"mc"===_("#fca_qc_quiz_type").val()?_("#fca_qc_questions_meta_box, #fca_qc_add_result_meta_box").show():_("#fca_qc_personality_questions_meta_box, #fca_qc_add_personality_result_meta_box").show()}).click(),_("#settings-nav").click(function(){_(".nav-tab-active").removeClass("nav-tab-active"),_(this).addClass("nav-tab-active").blur(),_("#fca_qc_description_meta_box, #fca_qc_questions_meta_box, #fca_qc_add_result_meta_box, #fca_qc_personality_questions_meta_box, #fca_qc_add_personality_result_meta_box").hide(),_("#fca_qc_quiz_settings_meta_box, #fca_qc_social_sharing_meta_box, #fca_qc_email_optin_meta_box, #fca_qc_appearance_meta_box").show()}),_("#fca_qc_add_question_btn").click(function(){t+=1,_(".fca_qc_question_input_div").hide();for(var a=fcaQcAdminData.questionDiv.replace(/{{QUESTION_NUMBER}}/g,t);-1!==a.indexOf("{{ID}}");)a=a.replace(/{{ID}}/,fca_qc_new_GUID());_(this).siblings(".fca_qc_sortable_questions").append(a),add_drag_and_drop_sort(),add_question_heading_text_handlers(),add_question_and_result_click_toggles(),attach_delete_button_handlers(),attach_image_upload_handlers(),attach_add_answer_button_handlers_free(),setScoreRanges(),setQuestionNumbers(_(this).siblings(".fca_qc_sortable_questions")),_("#fca_qc_explanations").change()}),_("#fca_qc_add_result_btn").click(function(){a+=1,_(".fca_qc_result_input_div").hide();var t=fcaQcAdminData.resultDiv.replace(/{{RESULT_NUMBER}}/g,a);t=t.replace(/{{ID}}/g,fca_qc_new_GUID()),_(this).siblings(".fca_qc_sortable_results").append(t),add_drag_and_drop_sort(),add_question_and_result_click_toggles(),attach_delete_button_handlers(),attach_image_upload_handlers(),add_result_heading_text_handlers(),setScoreRanges(),fca_attach_wysiwyg()}),_(".fca_qc_shortcode_input").click(function(_){this.select()}),_("#fca_qc_shortcode_label").click(function(t){_(".fca_qc_shortcode_input").select()}),_(".fca_qc_admin_label").click(function(t){_(this).next().focus()}),add_drag_and_drop_sort(),add_question_and_result_click_toggles(),add_question_heading_text_handlers(),add_result_heading_text_handlers(),attach_delete_button_handlers(),attach_add_answer_button_handlers_free(),setScoreRanges(),attach_image_upload_handlers()});for(var dragCheck=!1,fca_qc_hash_seed=[],i=0;i<256;i++)fca_qc_hash_seed[i]=(i<16?"0":"")+i.toString(16);